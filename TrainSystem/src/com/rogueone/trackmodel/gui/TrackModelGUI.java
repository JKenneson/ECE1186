/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package com.rogueone.trackmodel.gui;

import com.rogueone.trackmodel.Line;
import com.rogueone.trackmodel.Section;
import java.io.File;
import java.io.IOException;
import javax.swing.JFileChooser;
import org.apache.poi.openxml4j.exceptions.InvalidFormatException;
import com.rogueone.trackmodel.TrackModel;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;

/**
 *
 * @author kylemonto
 */
public class TrackModelGUI extends javax.swing.JPanel {
    
    TrackModel trackModel;

    /** Creates new form TrackModelGUI */
    public TrackModelGUI() {
        initComponents();
    }
    
    public TrackModelGUI(TrackModel tm) {
        initComponents();
        trackModel = new TrackModel();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        trackDataFileChooser = new javax.swing.JFileChooser();
        trackModelTabbedPane = new javax.swing.JTabbedPane();
        trackOverviewPanel = new javax.swing.JPanel();
        trackLayoutPanel = new javax.swing.JPanel();
        trackLayoutLabel = new javax.swing.JLabel();
        trackFailureModesPanel = new javax.swing.JPanel();
        trackCircuitFailureButton = new javax.swing.JButton();
        brokenRailFailureButton = new javax.swing.JButton();
        powerOutageFailureButton = new javax.swing.JButton();
        trackPositionsPanel = new javax.swing.JPanel();
        trainPositionsScrollPane = new javax.swing.JScrollPane();
        trainPositionsTable = new javax.swing.JTable();
        trackConfigurationPanel = new javax.swing.JPanel();
        trackConfigurationLoadButton = new javax.swing.JButton();
        jPanel8 = new javax.swing.JPanel();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        trackDetailsPanel = new javax.swing.JPanel();
        trackDetailsSelectionPanel = new javax.swing.JPanel();
        lineSectionPanel = new javax.swing.JPanel();
        lineSelectionComboBox = new javax.swing.JComboBox<>();
        sectionSelectionPanel = new javax.swing.JPanel();
        sectionSelectionComboBox = new javax.swing.JComboBox<>();
        blockSelectionPanel = new javax.swing.JPanel();
        blockSelectionComboBox = new javax.swing.JComboBox<>();
        trackDetailsDetailsPanel = new javax.swing.JPanel();
        blockPanel = new javax.swing.JPanel();
        blockScrollPane = new javax.swing.JScrollPane();
        blockTable = new javax.swing.JTable();
        switchPanel = new javax.swing.JPanel();
        switchScrollPane = new javax.swing.JScrollPane();
        switchTable = new javax.swing.JTable();
        stationPanel = new javax.swing.JPanel();
        stationScrolPane = new javax.swing.JScrollPane();
        stationTable = new javax.swing.JTable();
        failuresPanel = new javax.swing.JPanel();
        failuresScrollPane = new javax.swing.JScrollPane();
        failuresTable = new javax.swing.JTable();

        setMaximumSize(new java.awt.Dimension(1070, 720));
        setMinimumSize(new java.awt.Dimension(1070, 720));
        setName(""); // NOI18N
        setPreferredSize(new java.awt.Dimension(1070, 720));
        setVerifyInputWhenFocusTarget(false);
        addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentHidden(java.awt.event.ComponentEvent evt) {
                formComponentHidden(evt);
            }
        });

        trackLayoutPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Track Layout"));

        trackLayoutLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/rogueone/images/layout_small.jpg"))); // NOI18N

        javax.swing.GroupLayout trackLayoutPanelLayout = new javax.swing.GroupLayout(trackLayoutPanel);
        trackLayoutPanel.setLayout(trackLayoutPanelLayout);
        trackLayoutPanelLayout.setHorizontalGroup(
            trackLayoutPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(trackLayoutPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(trackLayoutLabel)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        trackLayoutPanelLayout.setVerticalGroup(
            trackLayoutPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(trackLayoutPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(trackLayoutLabel, javax.swing.GroupLayout.DEFAULT_SIZE, 552, Short.MAX_VALUE)
                .addContainerGap())
        );

        trackFailureModesPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Failure Modes"));
        trackFailureModesPanel.setLayout(new java.awt.GridLayout(1, 3));

        trackCircuitFailureButton.setText("Track Circuit");
        trackFailureModesPanel.add(trackCircuitFailureButton);

        brokenRailFailureButton.setText("Broken Rail");
        brokenRailFailureButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                brokenRailFailureButtonActionPerformed(evt);
            }
        });
        trackFailureModesPanel.add(brokenRailFailureButton);

        powerOutageFailureButton.setText("Power  Outage");
        trackFailureModesPanel.add(powerOutageFailureButton);

        trackPositionsPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Train Positions"));

        trainPositionsTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {"Red", "3", "19", "1357"},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Line", "Section", "Block", "ID"
            }
        ));
        trainPositionsScrollPane.setViewportView(trainPositionsTable);

        javax.swing.GroupLayout trackPositionsPanelLayout = new javax.swing.GroupLayout(trackPositionsPanel);
        trackPositionsPanel.setLayout(trackPositionsPanelLayout);
        trackPositionsPanelLayout.setHorizontalGroup(
            trackPositionsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(trackPositionsPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(trainPositionsScrollPane)
                .addContainerGap())
        );
        trackPositionsPanelLayout.setVerticalGroup(
            trackPositionsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, trackPositionsPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(trainPositionsScrollPane, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                .addContainerGap())
        );

        trackConfigurationPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Track Configuration"));

        trackConfigurationLoadButton.setText("Load Data File");
        trackConfigurationLoadButton.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                trackConfigurationLoadButtonMouseClicked(evt);
            }
        });
        trackConfigurationLoadButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                trackConfigurationLoadButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout trackConfigurationPanelLayout = new javax.swing.GroupLayout(trackConfigurationPanel);
        trackConfigurationPanel.setLayout(trackConfigurationPanelLayout);
        trackConfigurationPanelLayout.setHorizontalGroup(
            trackConfigurationPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(trackConfigurationLoadButton, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        trackConfigurationPanelLayout.setVerticalGroup(
            trackConfigurationPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(trackConfigurationLoadButton, javax.swing.GroupLayout.DEFAULT_SIZE, 66, Short.MAX_VALUE)
        );

        jPanel8.setBorder(javax.swing.BorderFactory.createTitledBorder("Track Status"));

        jLabel7.setForeground(new java.awt.Color(0, 153, 51));
        jLabel7.setText("Light 243 successfully repaired on block 19");

        jLabel8.setForeground(new java.awt.Color(255, 51, 51));
        jLabel8.setText("Broken rail on block 9418");

        jLabel9.setForeground(new java.awt.Color(255, 51, 51));
        jLabel9.setText("Track circuit failure on block 174");

        jLabel10.setForeground(new java.awt.Color(0, 153, 51));
        jLabel10.setText("Power restored to block 89");

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel7)
                    .addComponent(jLabel8)
                    .addComponent(jLabel9)
                    .addComponent(jLabel10))
                .addContainerGap(320, Short.MAX_VALUE))
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel7)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel8)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel9)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel10)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout trackOverviewPanelLayout = new javax.swing.GroupLayout(trackOverviewPanel);
        trackOverviewPanel.setLayout(trackOverviewPanelLayout);
        trackOverviewPanelLayout.setHorizontalGroup(
            trackOverviewPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(trackOverviewPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(trackLayoutPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(trackOverviewPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(trackConfigurationPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(trackPositionsPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(trackFailureModesPanel, javax.swing.GroupLayout.DEFAULT_SIZE, 582, Short.MAX_VALUE)
                    .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(63, Short.MAX_VALUE))
        );
        trackOverviewPanelLayout.setVerticalGroup(
            trackOverviewPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(trackOverviewPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(trackOverviewPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(trackLayoutPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(trackOverviewPanelLayout.createSequentialGroup()
                        .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(trackPositionsPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(trackConfigurationPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(trackFailureModesPanel, javax.swing.GroupLayout.PREFERRED_SIZE, 89, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(117, Short.MAX_VALUE))
        );

        trackModelTabbedPane.addTab("Track Overview", trackOverviewPanel);

        trackDetailsPanel.setMaximumSize(new java.awt.Dimension(1060, 710));
        trackDetailsPanel.setMinimumSize(new java.awt.Dimension(1060, 710));
        trackDetailsPanel.setPreferredSize(new java.awt.Dimension(1060, 710));

        trackDetailsSelectionPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Selection", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 1, 24))); // NOI18N
        trackDetailsSelectionPanel.setLayout(new java.awt.GridLayout(1, 3));

        lineSectionPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Line"));

        lineSelectionComboBox.setFont(new java.awt.Font("Dialog", 1, 18)); // NOI18N

        javax.swing.GroupLayout lineSectionPanelLayout = new javax.swing.GroupLayout(lineSectionPanel);
        lineSectionPanel.setLayout(lineSectionPanelLayout);
        lineSectionPanelLayout.setHorizontalGroup(
            lineSectionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(lineSectionPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(lineSelectionComboBox, 0, 306, Short.MAX_VALUE)
                .addContainerGap())
        );
        lineSectionPanelLayout.setVerticalGroup(
            lineSectionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(lineSectionPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(lineSelectionComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        trackDetailsSelectionPanel.add(lineSectionPanel);

        sectionSelectionPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Section"));

        sectionSelectionComboBox.setFont(new java.awt.Font("Dialog", 1, 18)); // NOI18N

        javax.swing.GroupLayout sectionSelectionPanelLayout = new javax.swing.GroupLayout(sectionSelectionPanel);
        sectionSelectionPanel.setLayout(sectionSelectionPanelLayout);
        sectionSelectionPanelLayout.setHorizontalGroup(
            sectionSelectionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(sectionSelectionPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(sectionSelectionComboBox, 0, 306, Short.MAX_VALUE)
                .addContainerGap())
        );
        sectionSelectionPanelLayout.setVerticalGroup(
            sectionSelectionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(sectionSelectionPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(sectionSelectionComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        trackDetailsSelectionPanel.add(sectionSelectionPanel);

        blockSelectionPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Block"));

        blockSelectionComboBox.setFont(new java.awt.Font("Dialog", 1, 18)); // NOI18N

        javax.swing.GroupLayout blockSelectionPanelLayout = new javax.swing.GroupLayout(blockSelectionPanel);
        blockSelectionPanel.setLayout(blockSelectionPanelLayout);
        blockSelectionPanelLayout.setHorizontalGroup(
            blockSelectionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(blockSelectionPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(blockSelectionComboBox, 0, 306, Short.MAX_VALUE)
                .addContainerGap())
        );
        blockSelectionPanelLayout.setVerticalGroup(
            blockSelectionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(blockSelectionPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(blockSelectionComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        trackDetailsSelectionPanel.add(blockSelectionPanel);

        trackDetailsDetailsPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Details", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 1, 24))); // NOI18N
        trackDetailsDetailsPanel.setPreferredSize(new java.awt.Dimension(800, 828));
        trackDetailsDetailsPanel.setLayout(new java.awt.GridLayout(4, 1));

        blockPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Block"));

        blockTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null, null, null, null, null}
            },
            new String [] {
                "ID", "Port A", "Port B", "Length", "Grade", "Speed Limit", "Elevation", "Cum Elevation", "Underground", "Crossing", "Beacon", "Occupied"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.Double.class, java.lang.Double.class, java.lang.Double.class, java.lang.Double.class, java.lang.Double.class, java.lang.Boolean.class, java.lang.Boolean.class, java.lang.String.class, java.lang.Boolean.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false, false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        blockTable.setRowHeight(30);
        blockScrollPane.setViewportView(blockTable);
        if (blockTable.getColumnModel().getColumnCount() > 0) {
            blockTable.getColumnModel().getColumn(0).setResizable(false);
            blockTable.getColumnModel().getColumn(1).setResizable(false);
            blockTable.getColumnModel().getColumn(2).setResizable(false);
            blockTable.getColumnModel().getColumn(3).setResizable(false);
            blockTable.getColumnModel().getColumn(4).setResizable(false);
            blockTable.getColumnModel().getColumn(5).setResizable(false);
            blockTable.getColumnModel().getColumn(6).setResizable(false);
            blockTable.getColumnModel().getColumn(7).setResizable(false);
            blockTable.getColumnModel().getColumn(8).setResizable(false);
            blockTable.getColumnModel().getColumn(10).setResizable(false);
            blockTable.getColumnModel().getColumn(11).setResizable(false);
        }

        javax.swing.GroupLayout blockPanelLayout = new javax.swing.GroupLayout(blockPanel);
        blockPanel.setLayout(blockPanelLayout);
        blockPanelLayout.setHorizontalGroup(
            blockPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(blockPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(blockScrollPane, javax.swing.GroupLayout.DEFAULT_SIZE, 962, Short.MAX_VALUE)
                .addContainerGap())
        );
        blockPanelLayout.setVerticalGroup(
            blockPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(blockPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(blockScrollPane, javax.swing.GroupLayout.DEFAULT_SIZE, 70, Short.MAX_VALUE)
                .addContainerGap())
        );

        trackDetailsDetailsPanel.add(blockPanel);

        switchPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Switch"));

        switchTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null}
            },
            new String [] {
                "ID", "Port A", "Port B", "Port C"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.Integer.class
            };
            boolean[] canEdit = new boolean [] {
                true, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        switchTable.setRowHeight(30);
        switchScrollPane.setViewportView(switchTable);
        if (switchTable.getColumnModel().getColumnCount() > 0) {
            switchTable.getColumnModel().getColumn(0).setResizable(false);
            switchTable.getColumnModel().getColumn(1).setResizable(false);
            switchTable.getColumnModel().getColumn(2).setResizable(false);
            switchTable.getColumnModel().getColumn(3).setResizable(false);
        }

        javax.swing.GroupLayout switchPanelLayout = new javax.swing.GroupLayout(switchPanel);
        switchPanel.setLayout(switchPanelLayout);
        switchPanelLayout.setHorizontalGroup(
            switchPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(switchPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(switchScrollPane, javax.swing.GroupLayout.DEFAULT_SIZE, 962, Short.MAX_VALUE)
                .addContainerGap())
        );
        switchPanelLayout.setVerticalGroup(
            switchPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(switchPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(switchScrollPane, javax.swing.GroupLayout.DEFAULT_SIZE, 70, Short.MAX_VALUE)
                .addContainerGap())
        );

        trackDetailsDetailsPanel.add(switchPanel);

        stationPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Station"));

        stationTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null}
            },
            new String [] {
                "ID", "Name", "Block A", "Block B", "Right", "Left"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.Boolean.class, java.lang.Boolean.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        stationTable.setRowHeight(30);
        stationScrolPane.setViewportView(stationTable);
        if (stationTable.getColumnModel().getColumnCount() > 0) {
            stationTable.getColumnModel().getColumn(0).setResizable(false);
            stationTable.getColumnModel().getColumn(1).setResizable(false);
            stationTable.getColumnModel().getColumn(2).setResizable(false);
            stationTable.getColumnModel().getColumn(3).setResizable(false);
            stationTable.getColumnModel().getColumn(4).setResizable(false);
            stationTable.getColumnModel().getColumn(5).setResizable(false);
        }

        javax.swing.GroupLayout stationPanelLayout = new javax.swing.GroupLayout(stationPanel);
        stationPanel.setLayout(stationPanelLayout);
        stationPanelLayout.setHorizontalGroup(
            stationPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(stationPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(stationScrolPane, javax.swing.GroupLayout.DEFAULT_SIZE, 962, Short.MAX_VALUE)
                .addContainerGap())
        );
        stationPanelLayout.setVerticalGroup(
            stationPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(stationPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(stationScrolPane, javax.swing.GroupLayout.DEFAULT_SIZE, 70, Short.MAX_VALUE)
                .addContainerGap())
        );

        trackDetailsDetailsPanel.add(stationPanel);

        failuresPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Failures"));

        failuresTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null}
            },
            new String [] {
                "Broken Rail", "Power Outage", "Track Circuit Broken"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Boolean.class, java.lang.Boolean.class, java.lang.Boolean.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        failuresTable.setRequestFocusEnabled(false);
        failuresTable.setRowHeight(30);
        failuresScrollPane.setViewportView(failuresTable);
        if (failuresTable.getColumnModel().getColumnCount() > 0) {
            failuresTable.getColumnModel().getColumn(0).setResizable(false);
            failuresTable.getColumnModel().getColumn(1).setResizable(false);
            failuresTable.getColumnModel().getColumn(2).setResizable(false);
        }

        javax.swing.GroupLayout failuresPanelLayout = new javax.swing.GroupLayout(failuresPanel);
        failuresPanel.setLayout(failuresPanelLayout);
        failuresPanelLayout.setHorizontalGroup(
            failuresPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 974, Short.MAX_VALUE)
            .addGroup(failuresPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(failuresPanelLayout.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(failuresScrollPane, javax.swing.GroupLayout.DEFAULT_SIZE, 962, Short.MAX_VALUE)
                    .addContainerGap()))
        );
        failuresPanelLayout.setVerticalGroup(
            failuresPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 82, Short.MAX_VALUE)
            .addGroup(failuresPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, failuresPanelLayout.createSequentialGroup()
                    .addContainerGap(18, Short.MAX_VALUE)
                    .addComponent(failuresScrollPane, javax.swing.GroupLayout.PREFERRED_SIZE, 58, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap()))
        );

        trackDetailsDetailsPanel.add(failuresPanel);

        javax.swing.GroupLayout trackDetailsPanelLayout = new javax.swing.GroupLayout(trackDetailsPanel);
        trackDetailsPanel.setLayout(trackDetailsPanelLayout);
        trackDetailsPanelLayout.setHorizontalGroup(
            trackDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(trackDetailsPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(trackDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(trackDetailsSelectionPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(trackDetailsDetailsPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(60, Short.MAX_VALUE))
        );
        trackDetailsPanelLayout.setVerticalGroup(
            trackDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(trackDetailsPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(trackDetailsSelectionPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(trackDetailsDetailsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, 460, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(130, Short.MAX_VALUE))
        );

        trackModelTabbedPane.addTab("Track Details", trackDetailsPanel);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(trackModelTabbedPane, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(trackModelTabbedPane, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
        );
    }// </editor-fold>//GEN-END:initComponents

    private void brokenRailFailureButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_brokenRailFailureButtonActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_brokenRailFailureButtonActionPerformed

    private void trackConfigurationLoadButtonMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_trackConfigurationLoadButtonMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_trackConfigurationLoadButtonMouseClicked

    private void trackConfigurationLoadButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_trackConfigurationLoadButtonActionPerformed

        trackDataFileChooser = new JFileChooser();
        int returnVal = trackDataFileChooser.showOpenDialog(this);
        if (returnVal == JFileChooser.APPROVE_OPTION) {
            File trackDataFile = trackDataFileChooser.getSelectedFile();
            try {
                trackModel.parseDataFile(trackDataFile);
                updateLineComboBox();
                updateSectionComboBox();
                updateBlockComboBox();
                lineSelectionComboBox.addItemListener(new LineChangeListener(this));
                sectionSelectionComboBox.addItemListener(new SectionChangeListener(this));
                blockSelectionComboBox.addItemListener(new BlockChangeListener(this));
            }
            catch (IOException ex) {
                System.out.println("problem accessing file"+trackDataFile.getAbsolutePath());
            }
            catch (InvalidFormatException ex) {
                System.out.println("Please select an .xlsx file.");
            }
        } else if (returnVal == JFileChooser.CANCEL_OPTION){
           System.out.println("File access cancelled by user.");
        }
        trackDataFileChooser.setVisible(true);
    }//GEN-LAST:event_trackConfigurationLoadButtonActionPerformed

    private void updateLineComboBox() {
        lineSelectionComboBox.setModel(new javax.swing.DefaultComboBoxModel(trackModel.getLines().toArray()));
    }
    
    private void updateSectionComboBox() {
        sectionSelectionComboBox.setModel(new javax.swing.DefaultComboBoxModel(((Line)(lineSelectionComboBox.getSelectedItem())).getSections().toArray()));
    }
    
    private void updateBlockComboBox() {
        blockSelectionComboBox.setModel(new javax.swing.DefaultComboBoxModel(((Section)(sectionSelectionComboBox.getSelectedItem())).getBlocks().toArray()));
    }
    
    private void formComponentHidden(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_formComponentHidden
        // TODO add your handling code here:
    }//GEN-LAST:event_formComponentHidden


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel blockPanel;
    private javax.swing.JScrollPane blockScrollPane;
    private javax.swing.JComboBox<String> blockSelectionComboBox;
    private javax.swing.JPanel blockSelectionPanel;
    private javax.swing.JTable blockTable;
    private javax.swing.JButton brokenRailFailureButton;
    private javax.swing.JPanel failuresPanel;
    private javax.swing.JScrollPane failuresScrollPane;
    private javax.swing.JTable failuresTable;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel lineSectionPanel;
    private javax.swing.JComboBox<String> lineSelectionComboBox;
    private javax.swing.JButton powerOutageFailureButton;
    private javax.swing.JComboBox<String> sectionSelectionComboBox;
    private javax.swing.JPanel sectionSelectionPanel;
    private javax.swing.JPanel stationPanel;
    private javax.swing.JScrollPane stationScrolPane;
    private javax.swing.JTable stationTable;
    private javax.swing.JPanel switchPanel;
    private javax.swing.JScrollPane switchScrollPane;
    private javax.swing.JTable switchTable;
    private javax.swing.JButton trackCircuitFailureButton;
    private javax.swing.JButton trackConfigurationLoadButton;
    private javax.swing.JPanel trackConfigurationPanel;
    private javax.swing.JFileChooser trackDataFileChooser;
    private javax.swing.JPanel trackDetailsDetailsPanel;
    private javax.swing.JPanel trackDetailsPanel;
    private javax.swing.JPanel trackDetailsSelectionPanel;
    private javax.swing.JPanel trackFailureModesPanel;
    private javax.swing.JLabel trackLayoutLabel;
    private javax.swing.JPanel trackLayoutPanel;
    private javax.swing.JTabbedPane trackModelTabbedPane;
    private javax.swing.JPanel trackOverviewPanel;
    private javax.swing.JPanel trackPositionsPanel;
    private javax.swing.JScrollPane trainPositionsScrollPane;
    private javax.swing.JTable trainPositionsTable;
    // End of variables declaration//GEN-END:variables

    class LineChangeListener implements ItemListener{
        
        TrackModelGUI trackModel;
        
        public LineChangeListener(TrackModelGUI tm) {
            trackModel = tm;
        }

        @Override
        public void itemStateChanged(ItemEvent event) {
           if (event.getStateChange() == ItemEvent.SELECTED) {
              trackModel.updateSectionComboBox();
           }
        }       
    }
    
    class SectionChangeListener implements ItemListener{
        
        TrackModelGUI trackModel;
        
        public SectionChangeListener(TrackModelGUI tm) {
            trackModel = tm;
        }
        
        @Override
        public void itemStateChanged(ItemEvent event) {
           if (event.getStateChange() == ItemEvent.SELECTED) {
              trackModel.updateBlockComboBox();
           }
        }       
    }
    
    class BlockChangeListener implements ItemListener{
        
        TrackModelGUI trackModel;
        
        public BlockChangeListener(TrackModelGUI tm) {
            trackModel = tm;
        }

        @Override
        public void itemStateChanged(ItemEvent event) {
           if (event.getStateChange() == ItemEvent.SELECTED) {
              
           }
        }       
    }

}
